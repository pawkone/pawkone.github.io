<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ruby Game : Demo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f8f8f8;
      color: #333;
      text-align: center;
      padding-top: 50px;
    }
    .container {
        background-color: #fff;
        padding: 40px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        display: inline-block;
        text-align: left;
        width: 65%;
    }
    #build-list {
        max-height: 400px;  /* or whatever height you like */
        overflow-y: auto;   /* enables scroll inside container */
        padding-right: 10px; /* keeps text away from scrollbar */
    }
    .controls {
      margin-bottom: 20px;
    }
    select {
      padding: 5px 10px;
      font-size: 1em;
    }
    .link-item {
      margin-bottom: 20px;
    }
    .link-item a {
      text-decoration: none;
      color: #0077cc;
      font-weight: bold;
    }
    .link-item a:hover {
      text-decoration: underline;
    }
    .link-description {
      display: block;
      font-size: 0.9em;
      color: #666;
    }
    /* unreleased style */
    .link-item.unreleased a {
      pointer-events: none;
      color: #aaa;
      text-decoration: line-through;
      cursor: not-allowed;
    }
    .link-item.unreleased .link-description {
      color: #bbb;
    }
    #loadMore {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      font-size: 1em;
      border: none;
      border-radius: 6px;
      background-color: #0077cc;
      color: white;
      cursor: pointer;
    }
    #loadMore:disabled {
      background-color: #aaa;
      cursor: not-allowed;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Ruby Game : Demo - Builds</h1>
    <p>NOTE: Webports are discontinued for now or forever since being too hard to setup.</p>
    
    <div class="controls">
      <label for="sort">Sort by: </label>
      <select id="sort">
        <option value="newest">Newest Released (default)</option>
        <option value="numeric">Numeric (Lowest â†’ Highest)</option>
      </select>
    </div>

    <div id="build-list"></div>
    <button id="loadMore">Load More</button>
    
    <a href="https://kone.infy.uk">Go back to kone.infy.uk</a>
  </div>

  <script>
    const builds = [
      {
        version: "build 1 - 23/08/2025 (OLD VERSION W/ ARG)",
        number: 1,
        link: "/builds/rubygamedemo--build-1--23-08-25.zip",
        description: "noreasonforwhatyoudid / arg build, an unfinished version of the og game plan"
      },
      {
        version: "build 2 - 06/09/2025",
        number: 2,
        link: "/builds/rubygamedemo--build-3--26-08-25.zip",
        description: "ruby game demo playtest build i guess"
      },
      {
        version: "build 3 - 06/09/2025",
        number: 2,
        link: "/builds/rubygamedemo--build-3--26-09-25.zip",
        description: "ruby game demo playtest build i guess (a early test version for build 4)"
      }
    ];

    // Fill unreleased up to 100
    const maxBuilds = 100;
    for (let i = 1; i <= maxBuilds; i++) {
      if (!builds.find(b => b.number === i)) {
        builds.push({
          version: `build ${i} - ??/??/????`,
          number: i,
          link: "",
          description: "not out or will never exist idk"
        });
      }
    }

    let currentIndex = 0;
    const chunkSize = 10;
    const container = document.getElementById("build-list");
    const loadMoreBtn = document.getElementById("loadMore");
    const sortSelect = document.getElementById("sort");

    let sortedBuilds = [];

    function sortBuilds() {
      if (sortSelect.value === "numeric") {
        sortedBuilds = [...builds].sort((a, b) => a.number - b.number);
      } else {
        // newest released first (highest released number on top)
        sortedBuilds = [...builds].sort((a, b) => {
          if (a.link && !b.link) return -1; // released before unreleased
          if (!a.link && b.link) return 1;
          return b.number - a.number; // higher numbers first
        });
      }
      resetAndRender();
    }

    function resetAndRender() {
      container.innerHTML = "";
      currentIndex = 0;
      loadMoreBtn.disabled = false;
      loadMoreBtn.textContent = "Load More";
      loadBuilds();
    }

    function loadBuilds() {
      const nextIndex = Math.min(currentIndex + chunkSize, sortedBuilds.length);
      for (let i = currentIndex; i < nextIndex; i++) {
        const build = sortedBuilds[i];
        const div = document.createElement("div");
        div.classList.add("link-item");
        if (!build.link) div.classList.add("unreleased");

        const a = document.createElement("a");
        a.href = build.link || "#";
        a.target = "_blank";
        a.textContent = build.version;

        const span = document.createElement("span");
        span.classList.add("link-description");
        span.textContent = build.description;

        div.appendChild(a);
        div.appendChild(span);
        container.appendChild(div);
      }
      currentIndex = nextIndex;

      if (currentIndex >= sortedBuilds.length) {
        loadMoreBtn.disabled = true;
        loadMoreBtn.textContent = "All builds loaded";
      }
    }

    loadMoreBtn.addEventListener("click", loadBuilds);
    sortSelect.addEventListener("change", sortBuilds);

    // initial load
    sortBuilds();
  </script>
</body>
</html>
